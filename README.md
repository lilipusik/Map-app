## Установка
1. Клонируйте репозиторий:
   ```bash
   git clone https://github.com/lilipusik/Map-app.git
   ```
2. Перейдите в директорию проекта:
   ```bash
   cd .\map-app\
   ```
3. Установите зависимости:
   ```bash
   npm install
   ```
4. Запустите проект:
   ```bash
   npx expo start --tunnel
   ```
5. Отсканируйте qr-code в приложении Expo Go и дождитесь полной загрузки приложения

## Принятые решения при реализации
### Лабораторная №1
1. При открытии приложения сразу загружается карта г. Перми
2. При долгом нажатии на выбранное место добавляется маркер (генерируется уникальный id, название маркера создается по приципу "Маркер {индекс маркера в списке + 1}", описание по умолчанию пустое, а адрес маркера проставляется по координатам через использование openstreetmap на русском языке)
3. При нажатии на ранее созданый маркер открывается меню для выбора действий (просмотра информации, удаления маркера и отмены открытия меню)
4. Просмотр информации предоставляет доступ к названию маркера, описанию, адресу и изображениям. Все данные, кроме адреса, можно редактировать и сохранять.
5. Состояния маркеров сохраняются глобавльно при помощи библиотеки zustand.

### Лабораторная №2
1. Локальное хранилище zustand было заменено на использование базы данных SQLite:
   - Схема базы данных (schema.ts):
   ```json
   CREATE TABLE IF NOT EXISTS markers (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        latitude REAL NOT NULL,
        longitude REAL NOT NULL,
        title CHAR NOT NULL,
        description TEXT,
        address TEXT NOT NULL,
        created_at DATETIME DEFAULT CURRENT_TIMESTAMP
      );

   `CREATE TABLE IF NOT EXISTS marker_images (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        marker_id INTEGER NOT NULL,
        uri TEXT NOT NULL,
        created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
        FOREIGN KEY (marker_id) REFERENCES markers (id) ON DELETE CASCADE
    );
   ```
   Созданы две таблицы: маркеры и изображения, привязанные к ним.
   - При загрузке карты происходит инициализация базы данных и чтение основной информации маркеров (название, расположение)
   - При выборе просмотра информации определенного маркера происходит чтение доп. полей (описание, адрес и изображения)
   - Общая логика:
      1. В schema.ts происходит подключение к базе данных и создание таблиц (если не были созданы ранее)
      2. В operations.ts прописаны все необходимые CRUD-операции с использованием подключения к бд из schema.ts (там же сделана обработка ошибок с выводом информации в консоль)
      3. Работа с базой данных происходит в DatabaseContext.ts для управления операциями во всем приложении (контекст упрощает передачу данных между компонентами, создает централизацию логику)

### Лабораторная №3
1. Инструкция по тестированию (для Android):
   1) Включить режим разработчика в настройках устройства
   2) Установить приложение GPS Joystick
   3) Зайти: Настройки -> Расширенные настройки -> Для разработчиков -> Выбрать приложение для фиктивных местоположений -> GPS Joystick
   4) Выбрать в GPS Joystick необходимое место положения, вставив шириту и долготу или выбрав место на карте
   
   Сценарии:
   1) Приближение к одной метке:
      - отправление уведомления о приближении к соответсвующей метке
   2) Приближение к нескольким меткам одновременно:
      - отправление нескольких уведомлениий о приближении к соответсвующим меткам (для каждой метки по одному ведомлению)
   3) Выход из зоны действия метки и повторное приближение:
      - отправка уведомления о приближении к соответсвующей метке при попадании в зону ее действия
      - удаление уведомления их активных при выходе из зоны действия метки
      - отправка уведомления о приближении к соответсвующей метке при попадании в зону ее действия
   4) Проверка уведомлений при смене состояния приложения (фоновый/активный режим):
      - активный режим: уведомления работают
      - фоновый режим: уведомления не работают
   5) Перезагрузка устройства при активных уведомлениях:
      - активные уведомления очищаются
      - приход повторных уведомлений

2. Описание стратегии управления уведомлениями:
   1) Создан класс для обработки и хранения активных уведомлений
   2) При загрузке класса вызывается запрос на разрешение отправки уведомлений
   3) При попадании в радиус 100 метров к метке (расстояние высчитывается через формулу Хаверсина) создается уведомление, сохраняясь в активных, и отправляется на устройство
   4) Пока человек находится не выходит из зоны метки, повторная отправка уведомлений не происходит
   5) При выходе из зоны метки уведомление удаляется из активных

3. Известные ограничения:
   1) Вывод ошибки при запрете к получению геолокации на устройстве
   2) При запрете на получение уведомлений, уведомления отправляться не будут

## Дополнительные реализованные функции
### Лабораторная №1
1. Использование StatusBar для зрительного объединения приложения со строкой состояния.
2. Предпросмотр изображений

### Лабораторная №3
1. Создана кнопка для перемещения точки местоположения в центр экрана устройства

## Проблемы и ограничения
1. Работа приложения проверена на Andriod, при работе с IOS могут возникнуть траблы